{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a6d2a36b_c5df724e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T09:40:47Z",
      "side": 1,
      "message": "It might not be clear to the reader what this workaround was.\n\nCould we explain it briefly that the EventMessage was enriching the Event message with some additional identifier, but now that\u0027s not needed because Event already has it?",
      "range": {
        "startLine": 9,
        "startChar": 60,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9587086f_85a13c45",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-06-18T00:03:50Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "a6d2a36b_c5df724e",
      "range": {
        "startLine": 9,
        "startChar": 60,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5d2936fa_7baa26b4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 10,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-06-18T18:17:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9587086f_85a13c45",
      "range": {
        "startLine": 9,
        "startChar": 60,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eab60a0a_9243b9b3",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T09:40:47Z",
      "side": 1,
      "message": "I don\u0027t see the relevant tag in the events-broker module [1].\nHas that just been forgotten?\n\n[1]https://gerrit.googlesource.com/modules/events-broker/",
      "range": {
        "startLine": 19,
        "startChar": 1,
        "endLine": 19,
        "endChar": 59
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4762e591_b1ad5c5f",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-06-16T10:02:33Z",
      "side": 1,
      "message": "Yeah our tagging is a controversial process. Usually we do not tag each version we just publish build to maven. @luca could you explain the process because it\u0027s not clear for me as well",
      "parentUuid": "eab60a0a_9243b9b3",
      "range": {
        "startLine": 19,
        "startChar": 1,
        "endLine": 19,
        "endChar": 59
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fcff113a_32cf2d0e",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T10:33:46Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4762e591_b1ad5c5f",
      "range": {
        "startLine": 19,
        "startChar": 1,
        "endLine": 19,
        "endChar": 59
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f4e3065d_88150782",
        "filename": "external_plugin_deps.bzl",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-06-18T00:03:50Z",
      "side": 1,
      "message": "Good catch, I\u0027ve created and pushed the tag: I just have forgotten about it.",
      "parentUuid": "fcff113a_32cf2d0e",
      "range": {
        "startLine": 19,
        "startChar": 1,
        "endLine": 19,
        "endChar": 59
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a757d44_07dd51bd",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-06-18T00:03:50Z",
      "side": 1,
      "message": "GerritInstanceId is mandatory here, isn\u0027t it?",
      "range": {
        "startLine": 79,
        "startChar": 6,
        "endLine": 79,
        "endChar": 15
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "96bffd92_dd1572a8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-06-18T18:17:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9a757d44_07dd51bd",
      "range": {
        "startLine": 79,
        "startChar": 6,
        "endLine": 79,
        "endChar": 15
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d8e86c7_5929ca14",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T09:40:47Z",
      "side": 1,
      "message": "What happens when instanceId is null?\nI understand there a CR[1] to ensure it is not, but that is only for multi-site right?\n\nDo we need to enforce it to be defined in all the components?\n\n[1]https://gerrit-review.googlesource.com/c/plugins/multi-site/+/309002",
      "range": {
        "startLine": 260,
        "startChar": 8,
        "endLine": 260,
        "endChar": 48
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af6e8c72_ad521275",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-06-16T10:02:33Z",
      "side": 1,
      "message": "Good point I will do that in a follow up change",
      "parentUuid": "3d8e86c7_5929ca14",
      "range": {
        "startLine": 260,
        "startChar": 8,
        "endLine": 260,
        "endChar": 48
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "60bb6d93_7ae70608",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T10:33:46Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "af6e8c72_ad521275",
      "range": {
        "startLine": 260,
        "startChar": 8,
        "endLine": 260,
        "endChar": 48
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "33823ce6_f5835b1d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-06-18T00:03:50Z",
      "side": 1,
      "message": "It cannot be null, otherwise the websession will loop by creating and receiving the same sessions.",
      "parentUuid": "60bb6d93_7ae70608",
      "range": {
        "startLine": 260,
        "startChar": 8,
        "endLine": 260,
        "endChar": 48
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a2eb68bc_9b52b31a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 262,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-16T09:40:47Z",
      "side": 1,
      "message": "Isn\u0027t setting the instanceId responsibility of the *broker* itself?\n\nLook at what the Gerrit\u0027s EventBroker does for example[1]\n\n```\nsetInstanceIdWhenEmpty(event);\n```\n\n[1]https://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/server/events/EventBroker.java#115",
      "range": {
        "startLine": 260,
        "startChar": 0,
        "endLine": 262,
        "endChar": 71
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "577f1816_0d9dfd48",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 262,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-06-18T00:03:50Z",
      "side": 1,
      "message": "-1, the broker is just responsible for sending and receiving events. The events need to be created with their instance-id from the start, exactly as Gerrit does.",
      "parentUuid": "a2eb68bc_9b52b31a",
      "range": {
        "startLine": 260,
        "startChar": 0,
        "endLine": 262,
        "endChar": 71
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83cc46ea_59c49d6f",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 262,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-18T05:56:01Z",
      "side": 1,
      "message": "\u003e -1, the broker is just responsible for sending and receiving events.\n\nWhy is that the case?\nI don\u0027t see why the broker couldn\u0027t also *stamp* the messages with the instanceId of the instance producing them, in fact I think it should.\nThis would allow to have one central place, where the setting of the instanceId happens, rather than copy/pasting the same code in every broker consumer.\n\n\u003e The events need to be created with their instance-id from the start, exactly as Gerrit does.\n\nIsn\u0027t [1], showing the opposite approach?\nThe EventBroker sets the instance-id (when not already set).\n\nAm I missing something?\n\n\n[1]thttps://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/server/events/EventBroker.java#115",
      "parentUuid": "577f1816_0d9dfd48",
      "range": {
        "startLine": 260,
        "startChar": 0,
        "endLine": 262,
        "endChar": 71
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6e736d5_8a79eba9",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 262,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2021-06-18T18:09:14Z",
      "side": 1,
      "message": "\u003e I don\u0027t see why the broker couldn\u0027t also *stamp* the messages with the instanceId of the instance producing them, in fact I think it should.\n\nBecause broker doesn\u0027t have knowledge if event was created by this instance or it\u0027s just forwarded one.",
      "parentUuid": "83cc46ea_59c49d6f",
      "range": {
        "startLine": 260,
        "startChar": 0,
        "endLine": 262,
        "endChar": 71
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8dd9bd2e_9564a586",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 262,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-06-18T18:22:48Z",
      "side": 1,
      "message": "\u003e \u003e I don\u0027t see why the broker couldn\u0027t also *stamp* the messages with the instanceId of the instance producing them, in fact I think it should.\n\u003e \n\u003e Because broker doesn\u0027t have knowledge if event was created by this instance or it\u0027s just forwarded one.\n\nIf it doesn\u0027t have instanceId it will set it, otherwise it will not, (since it is forwarded). Isn\u0027t this what [1] does? What would be the difference?\n\n[1]thttps://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/server/events/EventBroker.java#115",
      "parentUuid": "c6e736d5_8a79eba9",
      "range": {
        "startLine": 260,
        "startChar": 0,
        "endLine": 262,
        "endChar": 71
      },
      "revId": "5595ff241e4abfff3202955dddc2df10f38c774f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}