{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c1ea1cc0_71da55c7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 9,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T12:55:41Z",
      "side": 1,
      "message": "makes",
      "range": {
        "startLine": 9,
        "startChar": 41,
        "endLine": 9,
        "endChar": 45
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9927b53f_0dc87799",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 9,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-12-02T13:35:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c1ea1cc0_71da55c7",
      "range": {
        "startLine": 9,
        "startChar": 41,
        "endLine": 9,
        "endChar": 45
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7afb6800_44799048",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2022-12-02T13:06:58Z",
      "side": 1,
      "message": "Minor comments",
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "87b0a0be_f24e6e57",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 71,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2022-12-02T13:06:58Z",
      "side": 1,
      "message": "As i mentioned below. Because is a boolean maybe the name could give more context.",
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf2d12a7_38b387f8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 71,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-12-02T13:34:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "87b0a0be_f24e6e57",
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a105dd34_81b85735",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 94,
      "author": {
        "id": 1149185
      },
      "writtenOn": "2022-12-02T13:06:58Z",
      "side": 1,
      "message": "the method is returning a boolean. Do you think another name would provide more context?",
      "range": {
        "startLine": 94,
        "startChar": 18,
        "endLine": 94,
        "endChar": 38
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1d95b3b_1707cb91",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 94,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-12-02T13:34:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a105dd34_81b85735",
      "range": {
        "startLine": 94,
        "startChar": 18,
        "endLine": 94,
        "endChar": 38
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49ae88a0_2985f90e",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T12:55:41Z",
      "side": 1,
      "message": "Why 1024?\nIf `diskLimit` is not set, doesn\u0027t it mean that persistency for that cache is disabled?\n\nFrom the documentation\n```\nIf 0 or negative, persistence for the cache is disabled by default, but may still be overridden in the config.\n```",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "80910686_982b2628",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-12-02T13:04:54Z",
      "side": 1,
      "message": "we want to skip replay only of the cache is explicitly disabled in the configuration",
      "parentUuid": "49ae88a0_2985f90e",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65ec4a92_bd0826f9",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T13:56:32Z",
      "side": 1,
      "message": "\u003e we want to skip replay only of the cache is explicitly disabled in the configuration\n\nDid you mean that you want to skip the replay when the cache persistency is _enabled_, right? not when it is disabled.\n\nIt seems to me that, by default, `web_sessions` cache persistency is _disabled_ (`persistence for the cache is disabled by default`).\n\nIf that\u0027s the case, we should be replaying all sessions not skipping them.\n\nThe code above suggests that we will skip the replay instead, unless I am reading it wrong.",
      "parentUuid": "80910686_982b2628",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f42846f9_40b631b0",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-12-02T14:01:12Z",
      "side": 1,
      "message": "\u003e \u003e we want to skip replay only of the cache is explicitly disabled in the configuration\n\u003e \n\u003e Did you mean that you want to skip the replay when the cache persistency is _enabled_, right? not when it is disabled.\n\u003e \n\u003e It seems to me that, by default, `web_sessions` cache persistency is _disabled_ (`persistence for the cache is disabled by default`).\n\nAre you sure? If that was the case, all Gerrit sessions are lost upon restart.",
      "parentUuid": "65ec4a92_bd0826f9",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6b65924_59fe1248",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T14:09:51Z",
      "side": 1,
      "message": "mmm, I haven\u0027t tested directly, but by looking at the code I can see that:\n\n- persist does not define an explicit `diskLimit` [1]\n- By default `diskLimit` is disabled [2]\n\nAlso, the documentation seems to suggest so [3]\n\n```\nIf no disk cache is configured (or cache.web_sessions.diskLimit is set to 0) a server restart will force all users to sign-out, and need to sign-in again after the restart, as the cache was unable to persist the session information. Enabling a disk cache is strongly recommended.\n```\n\n[1]https://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/httpd/H2CacheBasedWebSession.java#42\n\n[2]https://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/server/cache/PersistentCacheBinding.java#47\n\n[3] https://gerrit-documentation.storage.googleapis.com/Documentation/3.0.0/config-gerrit.html#cache_names",
      "parentUuid": "f42846f9_40b631b0",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "691a5551_52e312d3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCache.java",
        "patchSetId": 5
      },
      "lineNbr": 95,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T16:30:03Z",
      "side": 1,
      "message": "I have tested this and by default the web_sessions *is* persisted, as you said @luca.milanesio@gmail.com.\nThe code involved is actually [1] and the default is 128 Mb.\n\nResolving this.\n\n[1]https://gerrit.googlesource.com/gerrit/+/refs/heads/stable-3.4/java/com/google/gerrit/server/cache/PersistentCacheProvider.java#54",
      "parentUuid": "e6b65924_59fe1248",
      "range": {
        "startLine": 95,
        "startChar": 69,
        "endLine": 95,
        "endChar": 73
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3c4d6fd_3655f6d8",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCacheTest.java",
        "patchSetId": 5
      },
      "lineNbr": 166,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-12-02T12:55:41Z",
      "side": 1,
      "message": "This number is irrelevant right, shouldn\u0027t use mockito anyInt() matcher here (and all other occurrences)?",
      "range": {
        "startLine": 166,
        "startChar": 67,
        "endLine": 166,
        "endChar": 71
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fbdfa6ac_f5c712e2",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/websession/broker/BrokerBasedWebSessionCacheTest.java",
        "patchSetId": 5
      },
      "lineNbr": 166,
      "author": {
        "id": 1083454
      },
      "writtenOn": "2022-12-02T13:34:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d3c4d6fd_3655f6d8",
      "range": {
        "startLine": 166,
        "startChar": 67,
        "endLine": 166,
        "endChar": 71
      },
      "revId": "0d4967ad47761487bac540b5dbf4d471eccb38c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}